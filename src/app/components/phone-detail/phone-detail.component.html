<!-- SECTION -->
<div class="section">
    <!-- container -->
    <div class="container">
        <!-- row -->
        <div class="row" style="justify-content: space-between;">
            <!-- Product main img -->
            <div class="col-md-5 col-md-push-2">
                <div id="product-main-img">
                    <div style="width: 355px; height: 320px;">
                        <img [src]="product?.descriptionImages[0]" alt="" width="100%" #mainImg>
                    </div>
                </div>
                <div class="d-flex">
                    <div class="thumbnails" *ngFor="let thumb of product?.descriptionImages">
                        <img [src]="thumb" #imgOver alt="" width="60px" height="60px"
                            (mouseover)="preview(mainImg, imgOver)">
                    </div>
                </div>

            </div>
            <!-- /Product main img -->

            <!-- Product details -->
            <div class="col-md-6 ml-5">
                <div class="product-details">
                    <h2 class="product-name">{{product?.name}}</h2>
                    <div>
                        <div class="product-rating">
                            <span *ngFor="let star of stars">
                                <i class="fa fa-star"
                                    [ngClass]="star.index <=rates[0]?.average ? 'fa-star':'fa-star-o'"></i>
                            </span>
                        </div>
                        <a class="review-link" style="cursor: pointer;" (click)="scroll(rate)">{{rates[0]?.total}} Đánh
                            giá | </a>
                        <a class="review-link" style="cursor: pointer;" (click)="scroll(comments)">1 Hỏi đáp</a>
                    </div>
                    <div style="margin: 10px 0">
                        <span style="font-weight: 800; font-size: 18px;">{{product?.price | currency: 'VND'}}</span>
                        <span class="product-available">{{ product?.quantity < 1 ? "Đang hết hàng" : "Còn hàng"
                                }}</span>
                    </div>
                    <div class="add-to-cart">
                        <div class="qty-label">
                            Số lượng
                            <div class="input-number">
                                <input type="number" value="1" #qty readonly style="outline: none;">
                                <span class="qty-up" (click)="increaseQuantity(qty)">+</span>
                                <span class="qty-down" (click)="decreaseQuantity(qty)">-</span>
                            </div>
                        </div>
                        <button class="add-to-cart-btn" (click)="addToCart(product, qty.value)"><i
                                class="fa fa-shopping-cart"></i> {{ product?.quantity < 1 ? "Đang hết hàng"
                                : "Thêm vào giỏ" }}</button>
                    </div>

                    <ul class="product-btns">
                        <li><a href="#"><i class="fa fa-heart-o"></i> Thêm vào yêu thích</a></li>

                    </ul>

                    <ul class="product-links">
                        <li>Số lượng còn:</li>
                        <li><a href="#">{{product?.quantity}}</a></li>
                    </ul>

                    <div *ngIf="qty.value == product?.quantity" class="no-stock">
                        Sản phẩm đang hết hàng
                    </div>
                </div>
                <div class="promotion-section">
                    <div class="promotion-title">
                        <span>Khuyến mãi</span>
                    </div>
                    <ul class="st-boxPromo__list st-boxPromo__list--more">
                        <li *ngFor="let pro of promotions"><i class="fa fa-check-circle"></i>
                            <div><span>{{ pro.name }}</span></div>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- /Product details -->
        </div>
        <!-- /row -->
    </div>
    <!-- /container -->
</div>
<div class="section">
    <div class="container">
        <div class="row">
            <div class="col-md-7 col-md-push-2">
                <h2 class="card-title">Đặc điểm nổi bật của {{product?.name}}</h2>
                <div class="card-body">
                    <div id="carouselExampleControls" class="carousel slide" data-interval="1000" data-ride="carousel"
                        data-pause="hover">
                        <div class="carousel-inner">
                            <div class="carousel-item active">
                                <img class="d-block w-100" [src]="product?.descriptionImages[0]" alt="First slide">
                            </div>
                            <div class="carousel-item" *ngIf="product?.descriptionImages[1]">
                                <img class="d-block w-100" [src]="product?.descriptionImages[1]" alt="Second slide">
                            </div>
                            <div class="carousel-item" *ngIf="product?.descriptionImages[2]">
                                <img class="d-block w-100" [src]="product?.descriptionImages[2]" alt="Third slide">
                            </div>
                        </div>
                        <a class="carousel-control-prev" href="#carouselExampleControls" role="button"
                            data-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="carousel-control-next" href="#carouselExampleControls" role="button"
                            data-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>
                    <p style="text-align:justify; margin-bottom:11px; font-size: 16px;">
                        <span style="font-weight: 500;">Đến với đẳng cấp Pro đích thực, nơi mà những
                            điều đặc biệt đang chờ đón bạn trên
                            <a [routerLink]="'/phones/' + product?._id" style="color: #d8341a;">{{product?.name}}</a>.
                            Từ
                            hệ thống camera Pro chụp thiếu sáng cực đỉnh,
                            kết nối 5G siêu tốc cho đến bộ vi xử lý A14 Bionic nhanh nhất thế giới smartphone, vẫn còn
                            nhiều bất ngờ khác để bạn khám phá.</span>
                    </p>
                </div>
            </div>
            <div class="col-md-5">
                <div>
                    <h2 class="card-title">Thông số kỹ thuật</h2>
                    <div class="card-body">
                        <table class="table table-striped table-bordered">
                            <tbody>
                                <tr>
                                    <td>Màn hình</td>
                                    <td><span>{{product?.screen}}</span></td>
                                </tr>
                                <tr>
                                    <td>Camera sau</td>
                                    <td><span>{{product?.camera}}</span></td>
                                </tr>
                                <tr>
                                    <td>Camera Selfie</td>
                                    <td><span>{{product?.selfieCamera}}</span></td>
                                </tr>
                                <tr>
                                    <td>RAM</td>
                                    <td><span>{{product?.ram}}</span></td>
                                </tr>
                                <tr>
                                    <td>Bộ nhớ trong</td>
                                    <td><span>{{product?.capacity}}</span></td>
                                </tr>
                                <tr>
                                    <td>CPU</td>
                                    <td><span>{{product?.cpu}}</span></td>
                                </tr>
                                <tr>
                                    <td>GPU</td>
                                    <td><span>{{product?.gpu}}</span></td>
                                </tr>
                                <tr>
                                    <td>Dung lượng pin</td>
                                    <td><span>{{product?.power}}</span></td>
                                </tr>
                                <tr>
                                    <td>Thẻ sim</td>
                                    <td><span>{{product?.sim}}</span></td>
                                </tr>
                                <tr>
                                    <td>Hệ điều hành</td>
                                    <td><span>{{product?.system}}</span></td>
                                </tr>
                                <tr>
                                    <td>Xuất xứ</td>
                                    <td><span>{{product?.origin}}</span></td>
                                </tr>
                                <tr>
                                    <td>Thời gian ra mắt</td>
                                    <td><span>{{product?.launched}}</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="section" #rate>
    <div class="container">
        <h2 class="card-title card-title--badge" style="align-items: center; justify-content: inherit;">Đánh giá &amp;
            Nhận xét sản phẩm
            <span class="badge text-white"
                style="background: rgb(220, 53, 69); font-size: 12px; font-weight: 500; margin-left:10px;">{{rates[0]?.total}}</span>
        </h2>
        <div class="row" style="padding-bottom: 16px;">
            <div class="col-md-4" style="text-align: center;">
                <p>Đánh giá Trung Bình</p>
                <div class="point" *ngIf="rates[0]?.total">{{rates[0]?.average}}/5</div>
                <div class="point" *ngIf="!rates[0]?.total">0/5</div>
                <div class="product-rating">
                    <span *ngFor="let star of stars">
                        <i class="fa fa-star" [ngClass]="star.index <=rates[0]?.average ? 'fa-star':'fa-star-o'"></i>
                    </span>
                </div>
                <span style="color: #99a2aa; ">{{rates[0]?.total}} đánh giá &amp; 0 nhận xét</span>
            </div>
            <div class="col-md-4">
                <div class="progress-list">
                    <div class="progress-item">
                        <label>5<i class="fa fa-star"
                                style="color: #ea9d02; font-size: 15px; margin-left: 2px;"></i></label>
                        <div class="progress-bar">
                            <span class="progress-value"
                                [style.width]="rates[0]?.fiveStars*100/rates[0]?.total + '%'"></span>
                        </div>
                        <span>{{rates[0]?.fiveStars}}</span>
                    </div>
                    <div class="progress-item">
                        <label>4<i class="fa fa-star"
                                style="color: #ea9d02; font-size: 15px; margin-left: 2px;"></i></label>
                        <div class="progress-bar">
                            <span class="progress-value"
                                [style.width]="rates[0]?.fourStars*100/rates[0]?.total + '%'"></span>
                        </div>
                        <span>{{rates[0]?.fourStars}}</span>
                    </div>
                    <div class="progress-item">
                        <label>3<i class="fa fa-star"
                                style="color: #ea9d02; font-size: 15px; margin-left: 2px;"></i></label>
                        <div class="progress-bar">
                            <span class="progress-value"
                                [style.width]="rates[0]?.threeStars*100/rates[0]?.total + '%'"></span>
                        </div>
                        <span>{{rates[0]?.threeStars}}</span>
                    </div>
                    <div class="progress-item">
                        <label>2<i class="fa fa-star"
                                style="color: #ea9d02; font-size: 15px; margin-left: 2px;"></i></label>
                        <div class="progress-bar">
                            <span class="progress-value"
                                [style.width]="rates[0]?.twoStars*100/rates[0]?.total + '%'"></span>
                        </div>
                        <span>{{rates[0]?.twoStars}}</span>
                    </div>
                    <div class="progress-item">
                        <label>1<i class="fa fa-star"
                                style="color: #ea9d02; font-size: 15px; margin-left: 2px;"></i></label>
                        <div class="progress-bar">
                            <span class="progress-value"
                                [style.width]="rates[0]?.oneStars*100/rates[0]?.total + '%'"></span>
                        </div>
                        <span>{{rates[0]?.oneStars}}</span>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="c-rate__right text-center">
                    <p class="small-para">Bạn đã dùng sản phẩm này?</p>
                    <a class="btn btn-primary" style="background: #cb1c22;color: #fff; border: none;"
                        (click)="openSendYourRateDiv()">Gửi đánh giá của
                        bạn</a>
                </div>
            </div>
        </div>
        <div class="row" style="padding: 16px 20px;
        background: #f8f9fa;" *ngIf="isSendRate">
            <div class="col-md-5">
                <div class="c-user-rate-star text-center" style="padding: 0 30px;">
                    <p style="font-weight: 500; margin-bottom: 8px; font-size: 18px; line-height: 24px;">Bạn chấm sản
                        phẩm này bao nhiêu sao?</p>
                    <form [formGroup]="form">
                        <ngx-star-rating formControlName="rating" [id]="'rating'"></ngx-star-rating>
                    </form>
                    <p class="f-err" style="display: none;">Vui lòng chọn đánh giá của bạn về sản phẩm này</p>
                </div>
            </div>
            <div class="col-md-7">
                <div class="c-user-rate-form">
                    <button class="btn btn-primary" (click)="sendRate()">Gửi đánh giá</button>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="section" #comments>
    <div class="container">
        <h2 class="card-title card-title--badge" style="align-items: center; justify-content: inherit;">Bình luận về
            {{product?.name}}
            <span class="badge text-white"
                style="background: rgb(220, 53, 69); font-size: 12px; font-weight: 500; margin-left:10px;">{{commentss?.length}}</span>
        </h2>
        <div class="row">
            <div class="col">
                <div class="c-user-rate-form f-comment-0">
                    <textarea name="" id="f-comment-0" rows="4" placeholder="Viết câu hỏi của bạn" name="question"
                        [(ngModel)]="yourQuestion" #firstQuestion></textarea>
                    <mat-error *ngIf="firstQuestion.value.length < 3 && isSendQuestion">Tối thiểu 3 kí tự</mat-error>
                    <button class="btn btn-primary" data-id="0" (click)="sendQuestion(firstQuestion.value)">Gửi câu
                        hỏi</button>
                </div>
            </div>
        </div>
        <div class="row" *ngFor="let item of parentComments">
            <div class="c-comment">
                <div class="c-comment-box">
                    <div class="c-comment-box__avatar">{{item.user_name.charAt(0)}}</div>
                    <div class="c-comment-box__content">
                        <div class="c-comment-name">{{item.user_name}}<div class="time">{{item.timeSince}}</div>
                        </div>
                        <div class="c-comment-text" data-idcmt="4815057">{{item.content}}</div>
                        <div class="c-comment-status"><a style="cursor: pointer;" (click)="reply(item)">Trả lời</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" *ngFor="let item2 of childComments" style="width: 100%">
                <div class="c-comment-box level2" *ngIf="item2.parent_id == item._id">
                    <div class="c-comment-box__avatar" style="display: none;">GVT</div>
                    <div class="c-comment-box__content">
                        <div class="c-comment-name">{{item2.user_name}}<span class="badge badge-primary"
                                *ngIf="item2.isAdmin == 'true'">Quản trị viên</span>
                            <div class="time">{{item2.timeSince}}</div>
                        </div>
                        <div class="c-comment-text" data-idcmt="4815063">
                            <p>Chào {{item.user_name.split(' ').slice(-1).join('')}},<br>
                                {{item2.content}}<br>
                                Thân mến!</p>
                        </div>
                        <div class="c-comment-status"></div>
                    </div>
                </div>
            </div>

            <div class="row" style="width: 100%; padding-left: 85px;" *ngIf="item.isReplied">
                <div class="col">
                    <div class="c-user-rate-form f-comment-0">
                        <textarea name="" id="f-comment-0" rows="4" placeholder="Viết câu hỏi của bạn"
                            #question></textarea>
                        <mat-error *ngIf="question.value.length < 3 && item.isReplied">Tối thiểu 3 kí tự</mat-error>
                        <button class="btn btn-primary" data-id="0" (click)="replyQuestion(question.value, item)">Gửi
                            câu hỏi</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- /SECTION -->
<div class="section">
    <!-- container -->
    <div class="container">
        <!-- row -->
        <div class="row">

            <!-- section title -->
            <div class="col-md-12">
                <div class="section-title">
                    <div style="display: flex; align-items: center;">
                        <img src="./assets/Images/hotsale-icon.png" alt="">
                        <h3 class="title">Sản phẩm liên quan</h3>
                    </div>
                    <div class="section-nav" style="margin-top: -30px;">
                        <ul class="section-tab-nav tab-nav">
                            <li class="active"><a data-toggle="tab" routerLink="/laptops">Laptops</a></li>
                            <li><a data-toggle="tab" routerLink="/phones">Điện thoại</a></li>
                            <li><a data-toggle="tab" routerLink="/cameras">Máy ảnh</a></li>
                            <li><a data-toggle="tab" routerLink="/accessories">Phụ kiện</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- /section title -->

            <!-- Products tab & slick -->
            <div class="col-md-12">
                <div class="row">
                    <div class="col-md-3 col-sm-6" *ngFor="let product of products">
                        <div class="product-card">
                            <div style="position: relative">
                                <a [routerLink]="['/accessories/', product._id]" target="_blank">
                                    <img [src]="product.descriptionImages[0]" width="200px" class="card-img-top"
                                        style="cursor: pointer;">
                                </a>
                            </div>
                            <div class="product-infor">
                                <div class="product-name">
                                    <p>{{product?.name}}</p>
                                </div>
                                <div class="product-price">
                                    <div class="saleprice">
                                        {{product.salePrice | currency: 'VND'}}
                                    </div>
                                    <div class="price">
                                        {{product.price | currency: 'VND'}}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <!-- Products tab & slick -->
        </div>
        <!-- /row -->
    </div>
    <!-- /container -->
</div>
<!-- /SECTION -->